#!/bin/sh

#----------------------------------#
# INSTALLING AND CONFIGURING ANBOX #
#----------------------------------#

paru -S --needed --noconfirm anbox-git
paru -S --needed --noconfirm anbox-image-houdini-rooted
paru -S --needed --noconfirm anbox-modules-dkms

# Activate binder and ashmem
sudo modprobe binder_linux devices=binder,hwbinder,vndbinder,anbox-binder,anbox-hwbinder,anbox-vndbinder
sudo modprobe ashmem_linux

# Mount binder
sudo mkdir -p /dev/binderfs
sudo mount -t binder binder /dev/binderfs

echo "ashmem_linux" | sudo tee -a /etc/modules-load.d/anbox.conf
echo "binder_linux" | sudo tee -a /etc/modules-load.d/anbox.conf

sudo systemctl enable  anbox-container-manager.service
sudo systemctl start   anbox-container-manager.service
